<!DOCTYPE html>
<html lang="zh-Hant-TW">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>晴天餅乾・Happinesscookie</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=home"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
  </head>
  <body>
    <%- include('./layout/header'); -%>
    <div class="container mt-5 pt-60">
      <div class="row">
        <div class="col-md-3">
          <div class="accordion" id="productMenu">
            <div class="accordion-item">
              <h2 class="accordion-header" id="headingHot">
                <button
                  class="accordion-button active-link"
                  type="button"
                  data-category="hot-products"
                >
                  熱門商品
                </button>
              </h2>
            </div>

            <div class="accordion-item">
              <h2 class="accordion-header" id="headingGift">
                <button
                  class="accordion-button collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#collapseGift"
                  aria-expanded="false"
                  aria-controls="collapseGift"
                >
                  來點禮盒
                </button>
              </h2>
              <div
                id="collapseGift"
                class="accordion-collapse collapse"
                aria-labelledby="headingGift"
                data-bs-parent="#productMenu"
              >
                <div class="accordion-body p-0">
                  <div class="list-group list-group-flush">
                    <a
                      href="#"
                      class="list-group-item list-group-item-action"
                      data-category="gift-festival"
                      >節慶禮盒</a
                    >
                    <a
                      href="#"
                      class="list-group-item list-group-item-action"
                      data-category="gift-baby"
                      >彌月禮盒</a
                    >
                    <a
                      href="#"
                      class="list-group-item list-group-item-action"
                      data-category="gift-small"
                      >送禮小物</a
                    >
                  </div>
                </div>
              </div>
            </div>

            <div class="accordion-item">
              <h2 class="accordion-header" id="headingVegan">
                <button
                  class="accordion-button collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#collapseVegan"
                  aria-expanded="false"
                  aria-controls="collapseVegan"
                >
                  我吃素
                </button>
              </h2>
              <div
                id="collapseVegan"
                class="accordion-collapse collapse"
                aria-labelledby="headingVegan"
                data-bs-parent="#productMenu"
              >
                <div class="accordion-body p-0">
                  <div class="list-group list-group-flush">
                    <a
                      href="#"
                      class="list-group-item list-group-item-action"
                      data-category="vegan-pure"
                      >純素</a
                    >
                    <a
                      href="#"
                      class="list-group-item list-group-item-action"
                      data-category="vegan-egg"
                      >蛋素</a
                    >
                    <a
                      href="#"
                      class="list-group-item list-group-item-action"
                      data-category="vegan-eggdairy"
                      >蛋奶素</a
                    >
                  </div>
                </div>
              </div>
            </div>

            <div class="accordion-item">
              <h2 class="accordion-header" id="headingPrice">
                <button
                  class="accordion-button collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#collapsePrice"
                  aria-expanded="false"
                  aria-controls="collapsePrice"
                >
                  價格
                </button>
              </h2>
              <div
                id="collapsePrice"
                class="accordion-collapse collapse"
                aria-labelledby="headingPrice"
                data-bs-parent="#productMenu"
              >
                <div class="accordion-body p-0">
                  <div class="list-group list-group-flush">
                    <a
                      href="#"
                      class="list-group-item list-group-item-action"
                      data-sort="price-asc"
                      >由低至高</a
                    >
                    <a
                      href="#"
                      class="list-group-item list-group-item-action"
                      data-sort="price-desc"
                      >由高至低</a
                    >
                  </div>
                </div>
              </div>
            </div>

            <hr />
            <div class="d-grid gap-2">
              <button class="btn btn-secondary" id="show-all-btn">
                顯示所有商品
              </button>
            </div>
          </div>
        </div>
        <div class="col-md-9">
          <div id="product-display" class="row">
            <div
              class="col-12 col-sm-6 col-md-4 mb-4 product-item"
              data-category="gift-festival"
              style="display: none"
            >
              <p>這是**節慶禮盒**商品A</p>
            </div>
            <div
              class="col-12 col-sm-6 col-md-4 mb-4 product-item"
              data-category="gift-festival"
              style="display: none"
            >
              <p>這是**節慶禮盒**商品B</p>
            </div>
            <div
              class="col-12 col-sm-6 col-md-4 mb-4 product-item"
              data-category="gift-baby"
              style="display: none"
            >
              <p>這是**彌月禮盒**商品C</p>
            </div>
            <div
              class="col-12 col-sm-6 col-md-4 mb-4 product-item"
              data-category="gift-small"
              style="display: none"
            >
              <p>這是**送禮小物**商品D</p>
            </div>
            <div
              class="col-12 col-sm-6 col-md-4 mb-4 product-item"
              data-category="vegan-pure"
              style="display: none"
            >
              <p>這是**純素**商品E</p>
            </div>
            <div
              class="col-12 col-sm-6 col-md-4 mb-4 product-item"
              data-category="vegan-eggdairy"
              style="display: none"
            >
              <p>這是**蛋奶素**商品F</p>
            </div>
            <div
              class="col-12 col-sm-6 col-md-4 mb-4 product-item"
              data-category="hot-products"
            >
              <p>這是**熱門**商品G</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <%-include('./layout/footer'); -%>

    <script type="module" src="../main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const filterButtons = document.querySelectorAll(".accordion-button");
        const filterLinks = document.querySelectorAll(".list-group-item");
        const allFilters = [...filterButtons, ...filterLinks];
        const products = document.querySelectorAll(".product-item");
        const showAllBtn = document.getElementById("show-all-btn");

        allFilters.forEach((element) => {
          element.addEventListener("click", (e) => {
            e.preventDefault();

            // 1. 清除所有選項的活躍樣式
            allFilters.forEach((el) => {
              el.classList.remove("active-link", "sub-category-active");
            });

            // 2. 根據點擊的元素類型，套用不同的活躍樣式
            if (e.target.classList.contains("accordion-button")) {
              // 點擊的是主分類按鈕，直接套用主要活躍樣式
              e.target.classList.add("active-link");
            } else if (e.target.classList.contains("list-group-item")) {
              // 點擊的是細項分類連結
              e.target.classList.add("sub-category-active");
              // 並為其父層按鈕加上主分類的活躍樣式
              const parentButton = e.target
                .closest(".accordion-item")
                ?.querySelector(".accordion-button");
              if (parentButton) {
                parentButton.classList.add("active-link");
              }
            }

            // 3. 處理商品顯示/隱藏的邏輯
            if (e.target.dataset.category) {
              const selectedCategory = e.target.dataset.category;
              products.forEach((product) => {
                product.style.display = "none";
                if (product.dataset.category === selectedCategory) {
                  product.style.display = "block";
                }
              });
            } else if (e.target.dataset.sort) {
              const sortType = e.target.dataset.sort;
              console.log(`進行排序: ${sortType}`);
            }
          });
        });

        showAllBtn.addEventListener("click", () => {
          allFilters.forEach((el) => {
            el.classList.remove("active-link", "sub-category-active");
          });
          products.forEach((product) => {
            product.style.display = "block";
          });
        });

        // 頁面載入時，預設將「熱門商品」設為活躍狀態
        document
          .querySelector('[data-category="hot-products"]')
          .classList.add("active-link");
      });
    </script>
  </body>
</html>
